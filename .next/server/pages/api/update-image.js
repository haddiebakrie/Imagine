"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/update-image";
exports.ids = ["pages/api/update-image"];
exports.modules = {

/***/ "formidable":
/*!*****************************!*\
  !*** external "formidable" ***!
  \*****************************/
/***/ ((module) => {

module.exports = require("formidable");

/***/ }),

/***/ "sharp":
/*!************************!*\
  !*** external "sharp" ***!
  \************************/
/***/ ((module) => {

module.exports = require("sharp");

/***/ }),

/***/ "file-type":
/*!****************************!*\
  !*** external "file-type" ***!
  \****************************/
/***/ ((module) => {

module.exports = import("file-type");;

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "./pages/api/update-image.ts":
/*!***********************************!*\
  !*** ./pages/api/update-image.ts ***!
  \***********************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__) => {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"config\": () => (/* binding */ config),\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var file_type__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! file-type */ \"file-type\");\n/* harmony import */ var formidable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! formidable */ \"formidable\");\n/* harmony import */ var formidable__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(formidable__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var sharp__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! sharp */ \"sharp\");\n/* harmony import */ var sharp__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(sharp__WEBPACK_IMPORTED_MODULE_3__);\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([file_type__WEBPACK_IMPORTED_MODULE_0__]);\nfile_type__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? await __webpack_async_dependencies__ : __webpack_async_dependencies__)[0];\n\n\n\n\nconst config = {\n    api: {\n        bodyParser: false\n    }\n};\nconst OUTPUT_ARR = [\n    \"png\",\n    \"jpeg\",\n    \"webp\"\n];\nconst streamToBuffer = async (stream)=>{\n    const buffer = [];\n    return new Promise((resolve, reject)=>stream.on(\"error\", (err)=>reject(err)\n        ).on(\"data\", (data)=>buffer.push(data)\n        ).on(\"end\", ()=>resolve(Buffer.concat(buffer))\n        )\n    );\n};\nasync function handler(req, res) {\n    const form = new formidable__WEBPACK_IMPORTED_MODULE_1__.IncomingForm({\n        maxFields: 2,\n        maxFileSize: 5 * 1024 * 1024\n    });\n    form.parse(req, async (err, fields, files)=>{\n        if (err) {\n            return res.status(400).json({\n                message: \"Something went wrong\"\n            });\n        }\n        const { file  } = files;\n        if (!file.length) {\n            let buff;\n            try {\n                buff = await streamToBuffer(fs__WEBPACK_IMPORTED_MODULE_2___default().createReadStream(file.filepath));\n            } catch (_) {\n                return res.status(400).json({\n                    message: \"Can not read sent image\"\n                });\n            }\n            const types = await (0,file_type__WEBPACK_IMPORTED_MODULE_0__.fileTypeFromBuffer)(buff);\n            if (!types || types.mime.split(\"/\")[0] !== \"image\") {\n                return res.status(400).json({\n                    message: \"File is not a valid image\"\n                });\n            }\n            const { quality , output  } = fields;\n            if (!quality || typeof quality !== \"string\") return res.status(400).json({\n                message: \"Quality has to be a valid field\"\n            });\n            const intQuality = parseInt(quality);\n            if (isNaN(intQuality)) return res.status(400).json({\n                message: \"Quality needs to be a valid string float\"\n            });\n            if (intQuality > 100) return res.status(400).json({\n                message: \"Quality can't be higher than 100%\"\n            });\n            if (intQuality < 10) return res.status(400).json({\n                message: \"Quality can't be lower than 10%\"\n            });\n            if (!output || typeof output !== \"string\") return res.status(400).json({\n                message: \"Output needs to be a valid string\"\n            });\n            if (!OUTPUT_ARR.find((o)=>o === output\n            )) return res.status(400).json({\n                message: \"Please select a valid output\"\n            });\n            switch(output){\n                case \"png\":\n                    buff = await sharp__WEBPACK_IMPORTED_MODULE_3___default()(buff).png({\n                        quality: intQuality\n                    }).toBuffer();\n                    break;\n                case \"webp\":\n                    buff = await sharp__WEBPACK_IMPORTED_MODULE_3___default()(buff).webp({\n                        quality: intQuality\n                    }).toBuffer();\n                    break;\n                case \"jpeg\":\n                default:\n                    buff = await sharp__WEBPACK_IMPORTED_MODULE_3___default()(buff).jpeg({\n                        quality: intQuality,\n                        mozjpeg: true\n                    }).toBuffer();\n                    break;\n            }\n            res.status(200).json({\n                base64: buff.toString(\"base64\")\n            });\n        } else {\n            res.status(400).json({\n                message: \"You can only compress a single image at a time\"\n            });\n        }\n    });\n};\n\n});//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEVBQUVjLEdBQUcsQ0FBQyxDQUFDO3dCQUFDUCxPQUFPLEVBQUVFLFVBQVU7b0JBQUMsQ0FBQyxFQUFFTSxRQUFRO29CQUM5RCxLQUFLO2dCQUNQLElBQUksQ0FBQyxDQUFNO29CQUNUZixJQUFJLEdBQUcsS0FBSyxDQUFDL0IsNENBQUssQ0FBQytCLElBQUksRUFBRWdCLElBQUksQ0FBQyxDQUFDO3dCQUFDVCxPQUFPLEVBQUVFLFVBQVU7b0JBQUMsQ0FBQyxFQUFFTSxRQUFRO29CQUMvRCxLQUFLO2dCQUNQLElBQUksQ0FBQyxDQUFNOztvQkFFVGYsSUFBSSxHQUFHLEtBQUssQ0FBQy9CLDRDQUFLLENBQUMrQixJQUFJLEVBQ3BCaUIsSUFBSSxDQUFDLENBQUM7d0JBQ0xWLE9BQU8sRUFBRUUsVUFBVTt3QkFDbkJTLE9BQU8sRUFBRSxJQUFJO29CQUNmLENBQUMsRUFDQUgsUUFBUTtvQkFDWCxLQUFLOztZQUdUM0IsR0FBRyxDQUFDTyxNQUFNLENBQUMsR0FBRyxFQUFFQyxJQUFJLENBQUMsQ0FBQztnQkFDcEJ1QixNQUFNLEVBQUVuQixJQUFJLENBQUNvQixRQUFRLENBQUMsQ0FBUTtZQUNoQyxDQUFDO1FBQ0gsQ0FBQyxNQUFNLENBQUM7WUFDTmhDLEdBQUcsQ0FBQ08sTUFBTSxDQUFDLEdBQUcsRUFBRUMsSUFBSSxDQUFDLENBQUM7Z0JBQ3BCQyxPQUFPLEVBQUUsQ0FBZ0Q7WUFDM0QsQ0FBQztRQUNILENBQUM7SUFDSCxDQUFDO0FBQ0gsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL2ltYWdlLWVkaXRvci8uL3BhZ2VzL2FwaS91cGRhdGUtaW1hZ2UudHM/MTM2NyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBmaWxlVHlwZUZyb21CdWZmZXIgfSBmcm9tIFwiZmlsZS10eXBlXCI7XHJcbmltcG9ydCB7IEZpbGUsIEluY29taW5nRm9ybSB9IGZyb20gXCJmb3JtaWRhYmxlXCI7XHJcbmltcG9ydCBmcyBmcm9tIFwiZnNcIjtcclxuaW1wb3J0IHR5cGUgeyBOZXh0QXBpUmVxdWVzdCwgTmV4dEFwaVJlc3BvbnNlLCBQYWdlQ29uZmlnIH0gZnJvbSBcIm5leHRcIjtcclxuaW1wb3J0IHNoYXJwIGZyb20gXCJzaGFycFwiO1xyXG5pbXBvcnQgdHlwZSB7IFJlYWRhYmxlIH0gZnJvbSBcInN0cmVhbVwiO1xyXG5pbXBvcnQgdHlwZSB7IHRPdXRwdXQgfSBmcm9tIFwiLi4vLi4vdHlwZXMvaW1hZ2Utc3RhdGVcIjtcclxuaW1wb3J0IHR5cGUgeyBJRXJyb3IsIElVcGRhdGVJbWFnZSB9IGZyb20gXCIuLi8uLi90eXBlcy91cGRhdGUtaW1hZ2UtaW50ZXJmYWNlXCI7XHJcblxyXG5leHBvcnQgY29uc3QgY29uZmlnOiBQYWdlQ29uZmlnID0ge1xyXG4gIGFwaToge1xyXG4gICAgYm9keVBhcnNlcjogZmFsc2UsXHJcbiAgfSxcclxufTtcclxuXHJcbmNvbnN0IE9VVFBVVF9BUlI6IHRPdXRwdXRbXSA9IFtcInBuZ1wiLCBcImpwZWdcIiwgXCJ3ZWJwXCJdO1xyXG5cclxuY29uc3Qgc3RyZWFtVG9CdWZmZXIgPSBhc3luYyAoc3RyZWFtOiBSZWFkYWJsZSk6IFByb21pc2U8QnVmZmVyPiA9PiB7XHJcbiAgY29uc3QgYnVmZmVyOiBVaW50OEFycmF5W10gPSBbXTtcclxuXHJcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+XHJcbiAgICBzdHJlYW1cclxuICAgICAgLm9uKFwiZXJyb3JcIiwgKGVycikgPT4gcmVqZWN0KGVycikpXHJcbiAgICAgIC5vbihcImRhdGFcIiwgKGRhdGEpID0+IGJ1ZmZlci5wdXNoKGRhdGEpKVxyXG4gICAgICAub24oXCJlbmRcIiwgKCkgPT4gcmVzb2x2ZShCdWZmZXIuY29uY2F0KGJ1ZmZlcikpKVxyXG4gICk7XHJcbn07XHJcblxyXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKFxyXG4gIHJlcTogTmV4dEFwaVJlcXVlc3QsXHJcbiAgcmVzOiBOZXh0QXBpUmVzcG9uc2U8SVVwZGF0ZUltYWdlIHwgSUVycm9yPlxyXG4pIHtcclxuICBjb25zdCBmb3JtID0gbmV3IEluY29taW5nRm9ybSh7XHJcbiAgICBtYXhGaWVsZHM6IDIsXHJcbiAgICBtYXhGaWxlU2l6ZTogNSAqIDEwMjQgKiAxMDI0LFxyXG4gIH0pO1xyXG5cclxuICBmb3JtLnBhcnNlKHJlcSwgYXN5bmMgKGVyciwgZmllbGRzLCBmaWxlcykgPT4ge1xyXG4gICAgaWYgKGVycikge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe1xyXG4gICAgICAgIG1lc3NhZ2U6IFwiU29tZXRoaW5nIHdlbnQgd3JvbmdcIixcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgeyBmaWxlIH0gPSBmaWxlcztcclxuICAgIGlmICghKGZpbGUgYXMgRmlsZVtdKS5sZW5ndGgpIHtcclxuICAgICAgbGV0IGJ1ZmY6IEJ1ZmZlcjtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBidWZmID0gYXdhaXQgc3RyZWFtVG9CdWZmZXIoXHJcbiAgICAgICAgICBmcy5jcmVhdGVSZWFkU3RyZWFtKChmaWxlIGFzIEZpbGUpLmZpbGVwYXRoKVxyXG4gICAgICAgICk7XHJcbiAgICAgIH0gY2F0Y2ggKF8pIHtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe1xyXG4gICAgICAgICAgbWVzc2FnZTogXCJDYW4gbm90IHJlYWQgc2VudCBpbWFnZVwiLFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zdCB0eXBlcyA9IGF3YWl0IGZpbGVUeXBlRnJvbUJ1ZmZlcihidWZmKTtcclxuICAgICAgaWYgKCF0eXBlcyB8fCB0eXBlcy5taW1lLnNwbGl0KFwiL1wiKVswXSAhPT0gXCJpbWFnZVwiKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcclxuICAgICAgICAgIG1lc3NhZ2U6IFwiRmlsZSBpcyBub3QgYSB2YWxpZCBpbWFnZVwiLFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zdCB7IHF1YWxpdHksIG91dHB1dCB9ID0gZmllbGRzO1xyXG5cclxuICAgICAgaWYgKCFxdWFsaXR5IHx8IHR5cGVvZiBxdWFsaXR5ICE9PSBcInN0cmluZ1wiKVxyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XHJcbiAgICAgICAgICBtZXNzYWdlOiBcIlF1YWxpdHkgaGFzIHRvIGJlIGEgdmFsaWQgZmllbGRcIixcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgIGNvbnN0IGludFF1YWxpdHkgPSBwYXJzZUludChxdWFsaXR5KTtcclxuICAgICAgaWYgKGlzTmFOKGludFF1YWxpdHkpKVxyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XHJcbiAgICAgICAgICBtZXNzYWdlOiBcIlF1YWxpdHkgbmVlZHMgdG8gYmUgYSB2YWxpZCBzdHJpbmcgZmxvYXRcIixcclxuICAgICAgICB9KTtcclxuICAgICAgaWYgKGludFF1YWxpdHkgPiAxMDApXHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcclxuICAgICAgICAgIG1lc3NhZ2U6IFwiUXVhbGl0eSBjYW4ndCBiZSBoaWdoZXIgdGhhbiAxMDAlXCIsXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIGlmIChpbnRRdWFsaXR5IDwgMTApXHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcclxuICAgICAgICAgIG1lc3NhZ2U6IFwiUXVhbGl0eSBjYW4ndCBiZSBsb3dlciB0aGFuIDEwJVwiLFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgaWYgKCFvdXRwdXQgfHwgdHlwZW9mIG91dHB1dCAhPT0gXCJzdHJpbmdcIilcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe1xyXG4gICAgICAgICAgbWVzc2FnZTogXCJPdXRwdXQgbmVlZHMgdG8gYmUgYSB2YWxpZCBzdHJpbmdcIixcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgIGlmICghT1VUUFVUX0FSUi5maW5kKChvKSA9PiBvID09PSBvdXRwdXQpKVxyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XHJcbiAgICAgICAgICBtZXNzYWdlOiBcIlBsZWFzZSBzZWxlY3QgYSB2YWxpZCBvdXRwdXRcIixcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgIHN3aXRjaCAob3V0cHV0IGFzIHRPdXRwdXQpIHtcclxuICAgICAgICBjYXNlIFwicG5nXCI6XHJcbiAgICAgICAgICBidWZmID0gYXdhaXQgc2hhcnAoYnVmZikucG5nKHsgcXVhbGl0eTogaW50UXVhbGl0eSB9KS50b0J1ZmZlcigpO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBcIndlYnBcIjpcclxuICAgICAgICAgIGJ1ZmYgPSBhd2FpdCBzaGFycChidWZmKS53ZWJwKHsgcXVhbGl0eTogaW50UXVhbGl0eSB9KS50b0J1ZmZlcigpO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBcImpwZWdcIjpcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgYnVmZiA9IGF3YWl0IHNoYXJwKGJ1ZmYpXHJcbiAgICAgICAgICAgIC5qcGVnKHtcclxuICAgICAgICAgICAgICBxdWFsaXR5OiBpbnRRdWFsaXR5LFxyXG4gICAgICAgICAgICAgIG1vempwZWc6IHRydWUsXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC50b0J1ZmZlcigpO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcclxuICAgICAgICBiYXNlNjQ6IGJ1ZmYudG9TdHJpbmcoXCJiYXNlNjRcIiksXHJcbiAgICAgIH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmVzLnN0YXR1cyg0MDApLmpzb24oe1xyXG4gICAgICAgIG1lc3NhZ2U6IFwiWW91IGNhbiBvbmx5IGNvbXByZXNzIGEgc2luZ2xlIGltYWdlIGF0IGEgdGltZVwiLFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9KTtcclxufVxyXG4iXSwibmFtZXMiOlsiZmlsZVR5cGVGcm9tQnVmZmVyIiwiSW5jb21pbmdGb3JtIiwiZnMiLCJzaGFycCIsImNvbmZpZyIsImFwaSIsImJvZHlQYXJzZXIiLCJPVVRQVVRfQVJSIiwic3RyZWFtVG9CdWZmZXIiLCJzdHJlYW0iLCJidWZmZXIiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsIm9uIiwiZXJyIiwiZGF0YSIsInB1c2giLCJCdWZmZXIiLCJjb25jYXQiLCJoYW5kbGVyIiwicmVxIiwicmVzIiwiZm9ybSIsIm1heEZpZWxkcyIsIm1heEZpbGVTaXplIiwicGFyc2UiLCJmaWVsZHMiLCJmaWxlcyIsInN0YXR1cyIsImpzb24iLCJtZXNzYWdlIiwiZmlsZSIsImxlbmd0aCIsImJ1ZmYiLCJjcmVhdGVSZWFkU3RyZWFtIiwiZmlsZXBhdGgiLCJfIiwidHlwZXMiLCJtaW1lIiwic3BsaXQiLCJxdWFsaXR5Iiwib3V0cHV0IiwiaW50UXVhbGl0eSIsInBhcnNlSW50IiwiaXNOYU4iLCJmaW5kIiwibyIsInBuZyIsInRvQnVmZmVyIiwid2VicCIsImpwZWciLCJtb3pqcGVnIiwiYmFzZTY0IiwidG9TdHJpbmciXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./pages/api/update-image.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = (__webpack_exec__("./pages/api/update-image.ts"));
module.exports = __webpack_exports__;

})();